<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
    <title>Post Purchase</title>
</head>
<body><script type="text/javascript">!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){(function(e){!function(e){"use strict";var t,r=e.URLSearchParams&&e.URLSearchParams.prototype.get?e.URLSearchParams:null,n=r&&"a=1"===new r({a:1}).toString(),i=r&&"+"===new r("s=%2B").get("s"),a=!r||((t=new r).append("s"," &"),"s=+%26"===t.toString()),s=d.prototype,o=!(!e.Symbol||!e.Symbol.iterator);if(!(r&&n&&i&&a)){s.append=function(e,t){g(this.__URLSearchParams__,e,t)},s.delete=function(e){delete this.__URLSearchParams__[e]},s.get=function(e){var t=this.__URLSearchParams__;return e in t?t[e][0]:null},s.getAll=function(e){var t=this.__URLSearchParams__;return e in t?t[e].slice(0):[]},s.has=function(e){return e in this.__URLSearchParams__},s.set=function(e,t){this.__URLSearchParams__[e]=[""+t]},s.toString=function(){var e,t,r,n,i=this.__URLSearchParams__,a=[];for(t in i)for(r=c(t),e=0,n=i[t];e<n.length;e++)a.push(r+"="+c(n[e]));return a.join("&")};var u=!!i&&r&&!n&&e.Proxy;Object.defineProperty(e,"URLSearchParams",{value:u?new Proxy(r,{construct:function(e,t){return new e(new d(t[0]).toString())}}):d});var l=e.URLSearchParams.prototype;l.polyfill=!0,l.forEach=l.forEach||function(e,t){var r=f(this.toString());Object.getOwnPropertyNames(r).forEach((function(n){r[n].forEach((function(r){e.call(t,r,n,this)}),this)}),this)},l.sort=l.sort||function(){var e,t,r,n=f(this.toString()),i=[];for(e in n)i.push(e);for(i.sort(),t=0;t<i.length;t++)this.delete(i[t]);for(t=0;t<i.length;t++){var a=i[t],s=n[a];for(r=0;r<s.length;r++)this.append(a,s[r])}},l.keys=l.keys||function(){var e=[];return this.forEach((function(t,r){e.push(r)})),p(e)},l.values=l.values||function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},l.entries=l.entries||function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),p(e)},o&&(l[e.Symbol.iterator]=l[e.Symbol.iterator]||l.entries)}function d(e){((e=e||"")instanceof URLSearchParams||e instanceof d)&&(e=e.toString()),this.__URLSearchParams__=f(e)}function c(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,(function(e){return t[e]}))}function h(e){return decodeURIComponent(e.replace(/\+/g," "))}function p(t){var r={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return o&&(r[e.Symbol.iterator]=function(){return r}),r}function f(e){var t={};if("object"==typeof e)for(var r in e)e.hasOwnProperty(r)&&g(t,r,e[r]);else{0===e.indexOf("?")&&(e=e.slice(1));for(var n=e.split("&"),i=0;i<n.length;i++){var a=n[i],s=a.indexOf("=");-1<s?g(t,h(a.slice(0,s)),h(a.slice(s+1))):a&&g(t,h(a),"")}}return t}function g(e,t,r){var n="string"==typeof r?r:null!=r&&"function"==typeof r.toString?r.toString():JSON.stringify(r);t in e?e[t].push(n):e[t]=[n]}}(void 0!==e?e:"undefined"!=typeof window?window:this)}).call(this,r(1))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.r(t);r(0);var n,i=function(){function e(){this._searchParams=new URLSearchParams(location.search)}return e.prototype.getBoolean=function(e,t){var r=this._searchParams.get(e);return null!=r?"true"===r:t},e.prototype.getString=function(e){return this._searchParams.get(e)},e.prototype.getNumber=function(e,t){var r=this._searchParams.get(e)||"",n=parseInt(r);return isNaN(n)?t:n},e}();!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.None=4]="None"}(n||(n={}));var a,s=function(){function e(){this._logLevel=n.None,this._logDelegate=null}return Object.defineProperty(e.prototype,"level",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"delegate",{get:function(){return this._logDelegate},set:function(e){this._logDelegate=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel===n.Debug&&(null!=this._logDelegate&&this._logDelegate.logDebug(this._stringifyParams(e)),console.log.apply(console,e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel<=n.Info&&(null!=this._logDelegate&&this._logDelegate.logDebug(this._stringifyParams(e)),console.info.apply(console,e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel<=n.Warn&&(null!=this._logDelegate&&this._logDelegate.logDebug(this._stringifyParams(e)),console.warn.apply(console,e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel<=n.Error&&(null!=this._logDelegate&&this._logDelegate.logError(this._stringifyParams(e)),console.error.apply(console,e))},e.prototype._stringifyParams=function(e){try{return JSON.stringify(e,null,2)}catch(e){return"Couldn't stringify logging params."}},e.default=new e,e}(),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",u=function(){function e(){}return e.randomString=function(e){void 0===e&&(e=10);for(var t="",r=0;r<e;r++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},e.capitalizeString=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.commaSplitString=function(e){return e.split(/,\s*/)},e.createUUIDv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.find=function(e,t,r){if(void 0!==Array.prototype.find)return e.find(t,r);if(!(null!==e&&e instanceof Array))throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var n=Object(e),i=n.length>>>0,a=0;a<i;a++){var s=n[a];if(t.call(r,s,a,n))return s}},e}(),l=function(){function e(e,t){this.isPublic=!1,this.isFatal=!1,this.message=e,this.actionType=t}return e.prototype.toParams=function(){var e={};return e.message=this.message,e.isPublic=1==this.isPublic?"true":"false",e.isFatal=1==this.isFatal?"true":"false",null!=this.actionType&&(e.actionType=this.actionType),null!=this.status&&(e.status=this.status),e},e}(),d=function(e,t,r){void 0===r&&(r={}),this.action=e,this.sender=t,this.receiver="Native",this.params=r,this.messageId=u.randomString()};!function(e){e.Debug="debug",e.Info="info",e.Error="error",e.All="all",e.Off="off"}(a||(a={}));var c,h=function(){function e(e,t){this.name=e,this.level=t}return e.PageLoad=new e("PostPurchaseWrapperPageLoad",a.Info),e.SdkFound=new e("PostPurchaseWrapperSdkFound",a.Debug),e.SdkNotFound=new e("PostPurchaseWrapperSdkNotFound",a.Debug),e.AddingMessageBridge=new e("PostPurchaseWrapperAddingMessageBridge",a.Debug),e.MessageBridgeAdded=new e("PostPurchaseWrapperMessageBridgeAdded",a.Debug),e.MessageBridgeLoadError=new e("PostPurchaseWrapperMessageBridgeLoadError",a.Error),e.InitializeNotCalled=new e("PostPurchaseWrapperInitializeNotCalled",a.Error),e.AddingLibrary=new e("PostPurchaseWrapperAddingLibrary",a.Debug),e.LibraryAlreadyAdded=new e("PostPurchaseWrapperLibraryAlreadyAdded",a.Debug),e.LibraryAdded=new e("PostPurchaseWrapperLibraryAdded",a.Debug),e.LibraryLoadError=new e("PostPurchaseWrapperLibraryLoadError",a.Error),e.ReceivedInitialize=new e("PostPurchaseWrapperReceivedInitialize",a.Info),e.ValidatedInitialize=new e("PostPurchaseWrapperValidatedInitialize",a.Debug),e.PerformingInitialize=new e("PostPurchaseWrapperPerformingInitialize",a.Debug),e.PerformedInitialize=new e("PostPurchaseWrapperPerformedInitialize",a.Debug),e.SentInitializeResponse=new e("PostPurchaseWrapperSentInitializeResponse",a.Info),e.InitializeException=new e("PostPurchaseWrapperInitializeException",a.Error),e.ReceivedAuthorize=new e("PostPurchaseWrapperReceivedAuthorize",a.Info),e.ValidatedAuthorize=new e("PostPurchaseWrapperValidatedAuthorize",a.Debug),e.PerformingAuthorize=new e("PostPurchaseWrapperPerformingAuthorize",a.Debug),e.PerformedAuthorize=new e("PostPurchaseWrapperPerformedAuthorize",a.Debug),e.SentAuthorizeResponse=new e("PostPurchaseWrapperSentAuthorizeResponse",a.Info),e.AuthorizeException=new e("PostPurchaseWrapperAuthorizeException",a.Error),e.ReceivedRender=new e("PostPurchaseWrapperReceivedRender",a.Info),e.ValidatedRender=new e("PostPurchaseWrapperValidatedRender",a.Debug),e.PerformingRender=new e("PostPurchaseWrapperPerformingRender",a.Debug),e.PerformedRender=new e("PostPurchaseWrapperPerformedRender",a.Debug),e.SentRenderResponse=new e("PostPurchaseWrapperSentRenderResponse",a.Info),e.RenderException=new e("PostPurchaseWrapperRenderException",a.Error),e}();!function(e){e[e.AsString=0]="AsString"}(c||(c={}));var p=function(){function e(e,t){this._errors=[],this._messages=[],this._queuedMessages=[],this._componentName="KlarnaPostPurchaseWrapper",this._storeErrorsAndMessages=e,this._analyticsController=t}return Object.defineProperty(e.prototype,"componentName",{get:function(){return this._componentName},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){var r=this;s.default.debug("Initializing MessageController."),e.addAsReceiver(this.componentName),e.addMessageCallback((function(e,n){r._receivedMessage(e,n,t)})),e.sendHandshake((function(n){null!=r._analyticsController&&null!=n&&r._analyticsController.setHandshakeMessage(n),t.addPostPurchaseLibrary(r,e,(function(n){n&&(r._queuedMessages.forEach((function(n){r._receivedMessage(n,e,t)})),r._queuedMessages=[])}))}))},e.prototype._receivedMessage=function(e,t,r){this._storeErrorsAndMessages&&this._messages.push(e);var n=e.receiver===this.componentName,i=u.find(["PostPurchaseInitialize","PostPurchaseAuthorizationRequest","PostPurchaseRenderOperation"],(function(t){return t===e.action}));if(n&&null!=i){if(!r.libraryAdded){s.default.error("Received a message to forward to Post Purchase Library, but it's not loaded.");var a=new l("Got message to Post Purchase Library, but it hasn't been added yet.",i);return this.sendError(a,t),void this._queuedMessages.push(e)}if("PostPurchaseInitialize"===i)(o={}).locale=e.params.locale,o.purchaseCountry=e.params.purchaseCountry,o.design=e.params.design,this._logAnalyticsEvent(h.ReceivedInitialize,o),this._handleInitialize(e,t,r);else if("PostPurchaseAuthorizationRequest"===i){(o={}).clientId=e.params.clientId,o.purchaseCountry=e.params.purchaseCountry,o.design=e.params.design,this._logAnalyticsEvent(h.ReceivedAuthorize,o),this._handleAuthorizationRequest(e,t,r)}else if("PostPurchaseRenderOperation"===i){var o;(o={}).locale=e.params.locale,o.operationToken=e.params.operationToken,o.redirectUri=e.params.redirectUri,this._logAnalyticsEvent(h.ReceivedRender,o),this._handleRenderOperation(e,t,r)}}},e.prototype._handleInitialize=function(e,t,r){if(s.default.debug("Handling Post Purchase initialize."),this._validateRequiredParam(e,t,"locale",c.AsString,!1,"PostPurchaseInitialize")&&this._validateRequiredParam(e,t,"purchaseCountry",c.AsString,!1,"PostPurchaseInitialize")&&this._validateRequiredParam(e,t,"design",c.AsString,!0,"PostPurchaseInitialize")){var n={locale:e.params.locale,purchase_country:e.params.purchaseCountry,design:e.params.design};r.performInitialize(n,this,t),this._logAnalyticsEvent(h.ValidatedInitialize)}},e.prototype._handleAuthorizationRequest=function(e,t,r){if(s.default.debug("Handling Post Purchase authorization request."),this._validateRequiredParam(e,t,"clientId",c.AsString,!1,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"locale",c.AsString,!0,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"scope",c.AsString,!1,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"redirectUri",c.AsString,!1,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"state",c.AsString,!0,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"loginHint",c.AsString,!0,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"responseType",c.AsString,!0,"PostPurchaseAuthorizationRequest")){this._logAnalyticsEvent(h.ValidatedAuthorize);var n={client_id:e.params.clientId,locale:e.params.locale,scope:e.params.scope,redirect_uri:e.params.redirectUri,state:e.params.state,login_hint:e.params.loginHint,response_type:e.params.responseType};r.performAuthorizationRequest(n,this,t)}},e.prototype._handleRenderOperation=function(e,t,r){if(s.default.debug("Handling Post Purchase render operation."),this._validateRequiredParam(e,t,"locale",c.AsString,!0,"PostPurchaseRenderOperation")&&this._validateRequiredParam(e,t,"operationToken",c.AsString,!1,"PostPurchaseRenderOperation")&&this._validateRequiredParam(e,t,"redirectUri",c.AsString,!0,"PostPurchaseRenderOperation")){this._logAnalyticsEvent(h.ValidatedRender);var n={locale:e.params.locale,operation_token:e.params.operationToken,redirect_uri:e.params.redirectUri};r.performRenderOperation(n,this,t)}},e.prototype._validateRequiredParam=function(e,t,r,n,i,a){if(void 0===e.params[r]){if(i)return!0;var s=new l("Param "+r+" is undefined.",a);return s.isPublic=!0,s.isFatal=!1,this.sendError(s,t),!1}if(null===e.params[r]){if(i)return!0;var o=new l("Param "+r+" is null.",a);return o.isPublic=!0,o.isFatal=!1,this.sendError(o,t),!1}if(n===c.AsString){var u=e.params[r];if(0==(null==u?void 0:u.length)){var d=new l("Param can't be an empty or blank string for "+r+".",a);return d.isPublic=!0,d.isFatal=!1,this.sendError(d,t),!1}}return!0},e.prototype.sendError=function(e,t){this._storeErrorsAndMessages&&this._errors.push(e),t.sendMessage(new d("PostPurchaseError",this.componentName,e.toParams()),null)},e.prototype._logAnalyticsEvent=function(e,t){null!=this._analyticsController&&this._analyticsController.reportEvent(e,t)},e}(),f=function(){function e(e,t){this.reqAction=e,this.resAction=t}return e.ResponseForAction=function(t){var r=u.find(e.PredefinedActions,(function(e){return e.reqAction===t}));return null!=r?r.resAction:null},e.HasResponse=function(e){return null!=this.ResponseForAction(e)},e.PredefinedActions=[new e("handshake","handshakeResponse")],e}(),g=function(){function e(){var e=this;this._receiverName=null,this._receivedMessages=[],this._sentMessages=[],this._allMessages=[],this._callbacks=[],this._storeAllMessages=!1,this._messageHandler=function(t){s.default.debug("Received message: \n"+JSON.stringify(t,null,2)),e._receivedMessages.push(t),e._storeAllMessages&&e._allMessages.push(t),e._notifyCallbacks(t)}}return Object.defineProperty(e.prototype,"storeAllMessages",{get:function(){return this._storeAllMessages},set:function(e){this._storeAllMessages=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"receiverName",{get:function(){return this._receiverName},enumerable:!1,configurable:!0}),e.prototype.addAsReceiver=function(e){null!=this._receiverName&&s.default.warn("Attempting to re-add as receiver "+e+"."),s.default.debug("Adding as receiver: "+e+"."),window.__KlarnaNativeHook.addReceiver(e,this._messageHandler),this._receiverName=e},e.prototype.removeAsReceiver=function(){window.__KlarnaNativeHook.removeReceiver(this._receiverName,this._messageHandler),this._receiverName=null},e.prototype.sendMessage=function(e,t){var r=this;this._storeAllMessages&&(this._sentMessages.push(e),this._allMessages.push(e)),s.default.debug("Sending message: \n"+JSON.stringify(e,null,2)),window.__KlarnaNativeHook.postMessage(e);var n=f.ResponseForAction(e.action);if(null!=t)if(null!=n)var i=window.setInterval((function(){var a=u.find(r._receivedMessages,(function(t){return t.action===n&&t.messageId===e.messageId}));null!=a&&(t(a),window.clearInterval(i))}),100);else t(null)},e.prototype.sendHandshake=function(e){if(null!=this._receiverName){var t=new d("handshake",this._receiverName);this.sendMessage(t,e)}},e.prototype._notifyCallbacks=function(e){var t=this;this._callbacks.forEach((function(r){r(e,t)}))},e.prototype.addMessageCallback=function(e){this._callbacks.push(e)},e.prototype.removeMessageCallback=function(e){this._callbacks=this._callbacks.filter((function(t){return t!==e}))},e}(),P=function(){function e(e,t,r){this._libraryAdded=!1,this._initialized=!1,this._environment=e,this._region=t,this._analyticsController=r}return Object.defineProperty(e.prototype,"libraryAdded",{get:function(){return this._libraryAdded},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initialized",{get:function(){return this._initialized},enumerable:!1,configurable:!0}),e.prototype.addPostPurchaseLibrary=function(e,t,r){var n=this;s.default.debug("Adding Klarna Post Purchase Library into page head."),this._logAnalyticsEvent(h.AddingLibrary,{environment:this._environment,region:this._region});null!=document.getElementById("PostPurchaseLibraryScript")&&(s.default.warn("Post Purchase Library already added to page. Won't add it again."),this._logAnalyticsEvent(h.LibraryAlreadyAdded),r(!1)),s.default.debug("Creating script element for Post Purchase Library as #PostPurchaseLibraryScript.");var i=document.createElement("script");i.src=this.getPostPurchaseLibraryUrl(this._environment,this._region),i.async=!0,i.addEventListener("load",(function(){n._libraryAdded=!0,s.default.debug("Post Purchase Library added."),n._logAnalyticsEvent(h.LibraryAdded),r(!0)})),i.addEventListener("error",(function(i){s.default.error("Error adding Post Purchase Lib.",i),n._logAnalyticsEvent(h.LibraryLoadError,{error:JSON.stringify(i)});var a=new l("Error adding Post Purchase library: "+i.message,"PostPurchaseCreate");a.isPublic=!1,a.isFatal=!0,e.sendError(a,t),r(!1)})),i.id="PostPurchaseLibraryScript",document.head.appendChild(i)},e.prototype.performInitialize=function(e,t,r){s.default.debug("Performing Klarna.PostPurchaseExperience.init()."),this._logAnalyticsEvent(h.PerformingInitialize);try{window.Klarna.PostPurchaseExperience.init(e),this._initialized=!0,this._logAnalyticsEvent(h.PerformedInitialize);var n=new d("PostPurchaseInitializeResponse",t.componentName);r.sendMessage(n,null),this._logAnalyticsEvent(h.SentInitializeResponse)}catch(e){s.default.error("Error performing Klarna.PostPurchaseExperience.init().",e),this._logAnalyticsEvent(h.InitializeException,{error:JSON.stringify(e)});var i=new l(e.message,"PostPurchaseInitialize");i.isPublic=!0,i.isFatal=!1,t.sendError(i,r)}},e.prototype.performAuthorizationRequest=function(e,t,r){if(s.default.debug("Performing Klarna.PostPurchaseExperience.authorizationRequest()."),this._logAnalyticsEvent(h.PerformingAuthorize),this.initialized)try{window.Klarna.PostPurchaseExperience.authorizationRequest(e),this._logAnalyticsEvent(h.PerformedAuthorize);var n=new d("PostPurchaseAuthorizationRequestResponse",t.componentName);r.sendMessage(n,null),this._logAnalyticsEvent(h.SentAuthorizeResponse)}catch(e){s.default.error("Error performing Klarna.PostPurchaseExperience.authorizationRequest().",e),this._logAnalyticsEvent(h.AuthorizeException,{error:JSON.stringify(e)});var i=new l(e.message,"PostPurchaseAuthorizationRequest");i.isPublic=!0,i.isFatal=!1,t.sendError(i,r)}else this.sendNotInitializedError(t,r,"PostPurchaseAuthorizationRequest")},e.prototype.performRenderOperation=function(e,t,r){var n=this;if(s.default.debug("Performing Klarna.PostPurchaseExperience.renderOperation()."),this._logAnalyticsEvent(h.PerformingRender),this.initialized)try{window.Klarna.PostPurchaseExperience.renderOperation(e,(function(e,i){if(e){s.default.error("Error performing Klarna.PostPurchaseExperience.renderOperation().",JSON.stringify(e)),n._logAnalyticsEvent(h.RenderException,{error:JSON.stringify(e)});var a=new l(e.message,"PostPurchaseRenderOperation");a.status=e.status,a.isPublic=!0,a.isFatal=!1,t.sendError(a,r)}else if(i){var o=new d("PostPurchaseRenderOperationResponse",t.componentName);o.params.renderOperationResult=i.status,r.sendMessage(o,null),n._logAnalyticsEvent(h.SentRenderResponse)}})),this._logAnalyticsEvent(h.PerformedRender)}catch(e){s.default.error("Error performing Klarna.PostPurchaseExperience.renderOperation().",e),this._logAnalyticsEvent(h.RenderException,{error:JSON.stringify(e)});var i=new l(e.message,"PostPurchaseRenderOperation");i.isPublic=!0,i.isFatal=!1,t.sendError(i,r)}else this.sendNotInitializedError(t,r,"PostPurchaseRenderOperation")},e.prototype.sendNotInitializedError=function(e,t,r){var n=new l("Post-Purchase SDK is not initialized. Please make sure to call initialize() first.",r);n.isPublic=!0,n.isFatal=!1,e.sendError(n,t),s.default.error("Post-Purchase SDK is not initialized. Please make sure to call initialize() first."),this._logAnalyticsEvent(h.InitializeNotCalled,{action:r})},e.prototype.getPostPurchaseLibraryUrl=function(e,t){var r="";if(e)switch(e.toLowerCase()){case"playground":r="playground/";break;case"staging":case"production":default:r=""}var n="";if(t)switch(t.toLowerCase()){case"na":case"oc":n="-"+t.toLowerCase();break;case"eu":default:n=""}return"staging"===e?"https://s3.int.klarna.net/smi/sdk/index"+n+".js":"https://x.klarnacdn.net/postpurchaseexperience/lib/v1/"+r+"sdk"+n+".js"},e.prototype._logAnalyticsEvent=function(e,t){null!=this._analyticsController&&this._analyticsController.reportEvent(e,t)},e}(),m=function(){function e(e,t){this._isLoaded=!1,this._analyticsController=e,this._endpoint=t}return Object.defineProperty(e.prototype,"isLoaded",{get:function(){return this._isLoaded},set:function(e){this._isLoaded=e},enumerable:!1,configurable:!0}),e.prototype.loadMessageBridge=function(e){var t=this;s.default.debug("Adding message bridge into page head."),this._logAnalyticsEvent(h.AddingMessageBridge),this.lookForMessageBridge(e);s.default.debug("Creating script element for Message Bridge as #MessageBridgeScript.");var r=document.createElement("script");r.src="https://"+this._endpoint.assetsHost+"/mobile-sdk/mobile-js-snippet/v1/app.min.js",r.async=!1,r.addEventListener("load",(function(){s.default.debug("Message bridge added."),t._logAnalyticsEvent(h.MessageBridgeAdded),t.isLoaded||(t.isLoaded=!0,e(!0))})),r.addEventListener("error",(function(e){s.default.error("Error adding Message bridge.",e),t._logAnalyticsEvent(h.MessageBridgeLoadError,{error:JSON.stringify(e)})})),r.id="MessageBridgeScript",document.head.appendChild(r)},e.prototype.lookForMessageBridge=function(e){if(null!=window.__KlarnaNativeHook)this.isLoaded||(this.isLoaded=!0,e(!0));else{var t=this;window.setTimeout((function(){t.lookForMessageBridge(e)}),500)}},e.prototype._logAnalyticsEvent=function(e,t){null!=this._analyticsController&&this._analyticsController.reportEvent(e,t)},e}(),v=function(){function e(){}return e.getEndpoint=function(t){return t&&u.find(e.endpoints,(function(e){return e.name===t.toLowerCase()}))||e.getDefaultEndpoint()},e.getDefaultEndpoint=function(){return e.endpoints[0]},e.endpointNameAws="aws",e.endpointNameAzure="azure",e.endpoints=[{name:e.endpointNameAws,assetsHost:"x.klarnacdn.net"},{name:e.endpointNameAzure,assetsHost:"z.klarnacdn.net"}],e}(),y=function(){function e(){this.additionalParams=null,this.event="undefined",this.sid="undefined",this.timestamp=Date.now()/1e3,this.wrapper={version:"undefined",environment:"undefined",region:"undefined"},this.device={os:"undefined",osVersion:"undefined",model:"undefined"},this.sdk={name:"undefined",version:"undefined",buildNumber:"undefined"},this.merchant={name:"undefined",packageName:"undefined",version:"undefined",buildNumber:"undefined"},this.additionalParams=null}return e.prototype.updateNativeParamsFromMessage=function(e){this.sdk.name=e.params.nativeName||"undefined",this.sdk.version=e.params.nativeVersion||"undefined",this.sdk.buildNumber=e.params.nativeBuildNumber||"undefined",this.device.model=e.params.deviceName||"undefined",this.device.os=e.params.osName||"undefined",this.device.osVersion=e.params.osVersion||"undefined",this.merchant.name=e.params.merchantAppName||"undefined",this.merchant.packageName=e.params.merchantAppID||"undefined",this.merchant.version=e.params.merchantAppVersion||"undefined",this.merchant.buildNumber=e.params.merchantAppBuildNumber||"undefined"},e.prototype.updateWithEvent=function(e,t){this.event=e.name,this.timestamp=Date.now()/1e3,this.additionalParams=t||null},e}(),_=function(){function e(e,t,r,n){this._analyticsData=new y,this._analyticsData.wrapper.environment=e,this._analyticsData.wrapper.region=t,this._analyticsData.wrapper.version="v1.0.0-3a27218bf2a",this._level=n,this._sid=u.createUUIDv4(),this._url=this.getAnalyticsUrl(e,t,r)}return e.prototype.setLevel=function(e){this._level=e},e.prototype.setHandshakeMessage=function(e){this._analyticsData.updateNativeParamsFromMessage(e)},e.prototype.reportEvent=function(e,t){this._analyticsData.updateWithEvent(e,t),this._analyticsData.sid=this._sid;var r=JSON.stringify(this._analyticsData);this._sendEvent(e,r)},e.prototype._sendEvent=function(e,t){if(this._shouldSendEvent(e)){s.default.debug("Sending event: "+e.name);var r="/v1/in-app/pp-wrapper/"+e.name,n=this._url+r;setTimeout((function(){window.fetch&&fetch(n,{method:"POST",body:t,mode:"no-cors"})}),0)}},e.prototype.getAnalyticsUrl=function(e,t,r){switch(r.name){case v.endpointNameAws:default:switch(e){case"production":default:return"https://eu.klarnaevt.com";case"playground":case"staging":return"https://frontend-event-router-eu.staging.c2c.klarna.net"}break;case v.endpointNameAzure:switch(e){case"production":default:return"https://naz.klarnaevt.com";case"playground":case"staging":return"naz.playground.klarnaevt.com"}}},e.prototype._shouldSendEvent=function(e){switch(this._level){case a.Off:return!1;case a.Error:return e.level===a.Error;case a.Info:return e.level===a.Info||e.level===a.Error;case a.Debug:return e.level===a.Debug||e.level===a.Info||e.level===a.Error;case a.All:return!0;default:return!1}},e}();window.addEventListener("load",(function(){var e,t,r,o,u,l,d=new i;s.default.level=d.getNumber("loglevel",n.None),s.default.debug("Page loaded. Initializing Post Purchase wrapper.");var c=v.getEndpoint(d.getString("endpoint")),f=null!==(t=null===(e=d.getString("environment"))||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"production",y=null!==(o=null===(r=d.getString("region"))||void 0===r?void 0:r.toLowerCase())&&void 0!==o?o:"eu",b=null!==(l=null===(u=d.getString("analyticslevel"))||void 0===u?void 0:u.toLowerCase())&&void 0!==l?l:a.Info,A=new _(f,y,c,b);A.reportEvent(h.PageLoad),new m(A,c).loadMessageBridge((function(e){if(e){var t=d.getBoolean("storeall",!1);!function(e,t,r,n){if(null!=window.__KlarnaNativeHook&&window.__KlarnaNativeHook.inSdkWebView()){s.default.debug("Running in SDK."),e.reportEvent(h.SdkFound);var i=new p(n,e),a=new g,o=new P(t,r,e);window.__WrapperMessageController=i,n&&(window.__NativeHookController=a),a.storeAllMessages=n,i.initialize(a,o)}else s.default.debug("Not running in SDK."),e.reportEvent(h.SdkNotFound)}(A,f,y,t)}}))}))}]);</script></body>
</html>
